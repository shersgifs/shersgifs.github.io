<!DOCTYPE html>
<html lang="uz">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Admin Panel – Sher's GIFs</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background-color: #0e0e0e;
      color: #fff;
      margin: 0;
      padding: 20px;
    }
    .container {
      max-width: 600px;
      margin: 0 auto;
    }
    .login-box, .admin-panel {
      background: #1a1a1a;
      padding: 30px;
      border-radius: 12px;
      box-shadow: 0 0 15px rgba(0, 255, 166, 0.3);
      margin-top: 50px;
    }
    h2 {
      text-align: center;
      color: #00ffa6;
      margin-bottom: 20px;
    }
    input, textarea, select {
      width: 100%;
      padding: 12px;
      margin-bottom: 15px;
      border: none;
      border-radius: 6px;
      background: #2a2a2a;
      color: #fff;
    }
    button {
      width: 100%;
      padding: 12px;
      background-color: #00ffa6;
      color: #000;
      border: none;
      border-radius: 6px;
      font-weight: bold;
      cursor: pointer;
    }
    button:hover {
      background-color: #00e6a0;
    }
    .error {
      color: #ff4d4d;
      font-size: 0.9em;
      margin-top: 10px;
      text-align: center;
    }
    .hidden {
      display: none;
    }
  </style>
  <script src="https://www.gstatic.com/firebasejs/11.9.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/11.9.1/firebase-database-compat.js"></script>
</head>
<body>
  <div class="container">
    <div class="login-box" id="login-box">
      <h2>Admin Panel</h2>
      <input type="text" id="username" placeholder="Foydalanuvchi nomi">
      <input type="password" id="password" placeholder="Parol">
      <button onclick="login()">Kirish</button>
      <div class="error" id="error-msg"></div>
    </div>

    <div class="admin-panel hidden" id="admin-panel">
      <h2>Saytni Boshqaruv Paneli</h2>
      <form onsubmit="addGif(event)">
        <label>GIF URL:</label>
        <input type="url" id="gif-url" placeholder="https://..." required>

        <label>GIF nomi (title):</label>
        <input type="text" id="gif-title" placeholder="Masalan: 🇺🇿 Khusanov Bayroq bilan" required>

        <button type="submit">GIF qo‘shish</button>
        <div id="add-msg" style="text-align:center;color:#00ffa6;margin-top:10px;"></div>
      </form>

      <hr style="margin:30px 0;border-color:#333">

      <div>
        <h3 style="color:#00ffa6;text-align:center;">Saytdagi GIFlar ro‘yxati</h3>
        <div id="gif-list"></div>
      </div>
    </div>
  </div>

  <script>
    const correctUsername = "Sheralii";
    const correctPassword = "Sherali2208$";

    function login() {
      const username = document.getElementById("username").value;
      const password = document.getElementById("password").value;
      const errorMsg = document.getElementById("error-msg");

      if (username === correctUsername && password === correctPassword) {
        document.getElementById("login-box").classList.add("hidden");
        document.getElementById("admin-panel").classList.remove("hidden");
        loadGifList();
      } else {
        errorMsg.textContent = "Noto‘g‘ri foydalanuvchi nomi yoki parol!";
      }
    }

    const firebaseConfig = {
      apiKey: "AIzaSyA_geIrm6qAJP8KOZ96OFYK2MOqfqZu8Nw",
      authDomain: "shers-gifs.firebaseapp.com",
      databaseURL: "https://shers-gifs-default-rtdb.firebaseio.com",
      projectId: "shers-gifs",
      storageBucket: "shers-gifs.appspot.com",
      messagingSenderId: "584232581574",
      appId: "1:584232581574:web:1fa299b284b61072d21ac7"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    function addGif(event) {
      event.preventDefault();
      const url = document.getElementById("gif-url").value.trim();
      const title = document.getElementById("gif-title").value.trim();
      const msg = document.getElementById("add-msg");

      if (url && title) {
        const id = btoa(url).replace(/=/g, '');
        db.ref('gifs/' + id).set({ url, title })
          .then(() => {
            msg.textContent = "✅ GIF muvaffaqiyatli qo‘shildi!";
            document.getElementById("gif-url").value = "";
            document.getElementById("gif-title").value = "";
            loadGifList();
          })
          .catch(error => {
            msg.textContent = "❌ Xatolik yuz berdi: " + error.message;
          });
      }
    }

    function loadGifList() {
      const gifListDiv = document.getElementById("gif-list");
      gifListDiv.innerHTML = "Yuklanmoqda...";
      db.ref("gifs").once("value")
        .then(snapshot => {
          const data = snapshot.val();
          if (data) {
            gifListDiv.innerHTML = Object.entries(data).map(([key, gif]) => `
              <div style="border-bottom:1px solid #333;margin:10px 0;padding-bottom:10px;">
                <strong>${gif.title}</strong><br>
                <img src="${gif.url}" alt="gif" style="max-width:100%;margin:8px 0;"><br>
                <button onclick="deleteGif('${key}')">🗑 O‘chirish</button>
              </div>
            `).join('');
          } else {
            gifListDiv.innerHTML = "Hech qanday GIF topilmadi.";
          }
        });
    }

    function deleteGif(id) {
      if (confirm("Bu GIFni rostdan ham o‘chirmoqchimisiz?")) {
        db.ref("gifs/" + id).remove()
          .then(() => loadGifList());
      }
    }
  </script>
</body>
</html>
